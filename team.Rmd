---
title: "team"
author: "Charles Yang, Julia Hernesman"
date: "9/24/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

```{r Re-labeling}
gss <- readxl::read_xlsx("GSS.xlsx")
gss %>% rename(
  year = `Gss year for this respondent`,
  happy = `General happiness`,
  party = `Political party affiliation`,
  race = `Race of respondent`,
  sex = `Respondents sex`,
  cdegree = `When received college degree`,
  hsdegree = `When received hs degree`,
  momdegree = `Mothers highest degree`,
  daddegree = `Fathers highest degree`,
  schoolyears = `Highest year of school completed`,
  age = `Age of respondent`,
  maried = `Marital status`,
  id = `Respondent id number`,
  balot = `Ballot used for interview`
) -> gss

str(gss)
```

```{r Cleaning}
gss$schoolyears <- as.numeric(gss$schoolyears)
gss$age <- as.numeric(gss$age)
```


```{r}
by_party <- group_by(gss, party)
schoolyears_by_party <- by_party %>% summarize(schoolyears=mean(schoolyears, na.rm=TRUE))
schoolyears_by_party <- na.omit(schoolyears_by_party)
partyfactor <- factor(schoolyears_by_party$party, levels=c("Strong democrat", "Not str democrat", "Ind,near dem", "Independent", "Ind,near rep", "Not str republican", "Strong republican","Don't know", "No answer", "Other party"))

ggplot(schoolyears_by_party, aes(x=partyfactor, y=schoolyears, fill=partyfactor)) +
  geom_bar(stat="identity") +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
  xlab("Party") +
  ylab("Years of School") +
  ggtitle("Years of School by Party Affiliation") +
  ylim(0, 20) +
  scale_fill_manual("Legend", values=c("Strong democrat"="#0C00FF", "Not str democrat"="#756EFF", "Ind,near dem"="#A39EFF", "Independent"="#FF00FB", "Ind,near rep"="#FEABAB", "Not str republican"="#FC6B6B", "Strong republican"="#FF0000", "Don't know"="#BABABA", "No answer"="#666666", "Other party"="#000000"))
```

```{r}
betterEd <- gss %>% group_by(party) %>% filter(schoolyears > median(schoolyears, na.rm = TRUE))
str(betterEd)
```

